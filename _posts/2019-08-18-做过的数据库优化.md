---
layout:     post
title:	做过的数据库哪些优化？
subtitle: 	做过的数据库哪些优化？
date:       2019-08-18
author:     chuangkel
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - 数据库
---

# 做过的数据库哪些优化？

## 数据库优化具备的基础知识

> explain 只能解释select查询语句。select 查看查询语句的执行计划

### 执行计划实践

```mysql
CREATE TABLE `user_info` (
  `id`   BIGINT(20)  NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(50) NOT NULL DEFAULT '',
  `age`  INT(11)              DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `name_index` (`name`)
)
  ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

INSERT INTO user_info (name, age) VALUES ('xys', 20);
INSERT INTO user_info (name, age) VALUES ('a', 21);
INSERT INTO user_info (name, age) VALUES ('b', 23);
INSERT INTO user_info (name, age) VALUES ('c', 50);
INSERT INTO user_info (name, age) VALUES ('d', 15);
INSERT INTO user_info (name, age) VALUES ('e', 20);
INSERT INTO user_info (name, age) VALUES ('f', 21);
INSERT INTO user_info (name, age) VALUES ('g', 23);
INSERT INTO user_info (name, age) VALUES ('h', 50);
INSERT INTO user_info (name, age) VALUES ('i', 15);
```



#### explain返回的字段：

* id  每一个select都会返回一个id
* select_type
  * simple ，表示此查询不包含 UNION 查询或子查询
  * primary，表示此查询是最外层的查询
  * union，
  * dependent union，
  * ...
* table
* partitions
* type 访问类型
  * null ：eg. select max() from ...
  
  * system/const ：where 后面=是常量
  
  * eq_ref 多表查询时，根据非唯一空索引进行查询
  
  * ref 多表查询时，根据非唯一非空索引进行查询
  
  * range 在索引上进行范围查找：当=,< ,> ,<=,>=,<>,<=>,in,between,is null
  
    * <=> 安全比较运算符，用来做 NULL 值的关系运算SELECT 1 <=> NULL, !(1 <=> NULL);// 结果0,1
  
    * != 和 not in 不走索引
  
    * @用来标识用户变量，@@用来标识系统变量 
  
  * index 遍历索引树
  
  * all 全表扫描
  
  * 比较：ALL < index < range ~ index_merge < ref < eq_ref < const < system<null
* possible_keys 查询中可能使用的索引
* key 实际中使用到的索引
* key_len 实际索引长度
* rows此次查询所需读取的行数。越小越好
* extra 
  * Using index 在查询树中就可查询到数据，没有操作数据表。
  * Using index condition
  * Using temporary使用了临时表，一般出现于join,排序，分组的情况。
  * Using filesort 没有使用索引排序，进行了额外的排序。可以对排序字段加索引。
    * 下面的例子：dim_id有索引（主键），dim_name无索引
      * EXPLAIN select * from hg_tdimension order by dim_id; // type:index,extra:null
      * EXPLAIN select * from hg_tdimension order by dim_name; // type:all,extra:Using filesort



### 数据库优化的思路

* 加索引
* 语句优化
* 分库分表






数据库优化点

数据库优化总结